# My Application

The project is generated by [LoopBack](http://loopback.io).

## API presentation

### Account

#### Description

Symbolize an association, used as user for login.

```
{
    "id": 0(auto_increment),
    "association_name": "string",
    "realm": "string(optional)",
    "username": "string(optional)",
    "email": "string",
    "password": "string(auto_hash)",
    "emailVerified": false(optional)
}
```

#### Routes

##### Create a new account.
`POST /Accounts`

###### Input
```
{
  "association_name": "string",
  "email": "string",
  "password": "string"
}
```

Note : Password will be hash automatically by the API.

###### Success

Response code `200`.

Response body 

```
{
  "association_name": "string",
  "email": "string",
  "id": 0
}
```

##### Login
`POST /Accounts/login` 

###### Input 
```
{
  "email": "string", 
  "password": "string"
}
```

###### Success

Response code `200`.

Response body 
```
{
  "id": "VGJYBOEfAPcK09TeJyGc6J35LdhudpS612UJneyUBCQBepZ8W732x2Pj5zGC0sx2",
  "ttl": 1209600,
  "created": "2018-10-18T11:58:15.084Z",
  "userId": 7
}
```

With id the accessToken delivered to the user

###### Failure : Wrong password/email address

Response code `401`.

Response body
```
{
  "error": {
    "statusCode": 401,
    "name": "Error",
    "message": "échec de la connexion",
    "code": "LOGIN_FAILED",
    "stack": "Error: échec de la connexion\n ...
  }
}
```

##### Get the news from an account

`GET /Accounts/{id}/news`

###### Success

`GET /Accounts/4/news`

Response code `200`.

Response body

```
[
  {
    "title": "News1",
    "content": "The content of the news 1",
    "publish_date": "2018-10-17T18:39:22.000Z",
    "created_date": "2018-10-17T18:39:22.000Z",
    "updated_date": "2018-10-17T18:39:22.000Z",
    "image": "news1.png",
    "id": 2,
    "accountId": 4
  },
  {
    "title": "News2",
    "content": "The content of the news 2",
    "publish_date": "2018-10-17T18:39:22.000Z",
    "created_date": "2018-10-17T18:39:22.000Z",
    "updated_date": "2018-10-17T18:39:22.000Z",
    "image": "news2.png",
    "id": 3,
    "accountId": 4
  }
]
```

### Container
The containers refers to the directory which contains files.

Every association will own a container in which we'll put every image.

Every container also contains a property file.

#### Routes

##### Create a new container

`POST /container`

###### Input 
```
{
  "name": "test"
}
```

###### Success
Response code `200`.

Response body

```
{
  "name": "test",
  "size": 0,
  "atime": "2018-10-18T12:16:14.281Z",
  "mtime": "2018-10-18T12:16:14.281Z",
  "ctime": "2018-10-18T12:16:14.281Z"
}
```

##### Upload a file

`POST /containers/{container}/upload`

The request body should use the [multipart/form-data](https://www.ietf.org/rfc/rfc2388.txt) as HTML type.

The request body also needs an argument as File.

###### Input

```
Content-Type: multipart/form-data;

Content-Disposition: form-data; name=""; filename="lourd.PNG"
Content-Type: image/png
```

###### Success 

`POST /containers/test/upload`

Response code `200`

Response body
```
{
    "result": {
        "files": {
            "": [
                {
                    "container": "test",
                    "name": "lourd.PNG",
                    "type": "image/png",
                    "field": "",
                    "size": 49935
                }
            ]
        },
        "fields": {}
    }
}
```

###### Download a file

`GET /containers/{container}/download/{file}`

Download a file from the API

###### Success

`GET /containers/test/download/lourd.png`

Response code `200`

Response body : File

### News

Refers to the news of the association.

```
{
  "id": 0,
  "title": "string",
  "content": "string",
  "publish_date": "2018-10-18T11:31:16.512Z",
  "created_date": "2018-10-18T11:31:16.512Z",
  "updated_date": "2018-10-18T11:31:16.512Z",
  "image": "string",
  "accountId": 0
}
```

#### Routes

##### Create a news

`POST /news`

###### Input

```
{
  "title": "string",
  "content": "string",
  "publish_date": "2018-10-18T11:31:16.512Z",
  "created_date": "2018-10-18T11:31:16.512Z",
  "updated_date": "2018-10-18T11:31:16.512Z",
  "image": "string",
  "accountId": 0
}
```

The image fields refers to the name of the image to use. 
Note that the image can be download using the route 
`GET /containers/{container}/download/{file}`

The accountId fields refers to the account to link with. It is used
to get the news from an account by using the route 
`GET /Accounts/{id}/news`

###### Success

Response code `200`

Response body 

```
{
  "title": "string",
  "content": "string",
  "publish_date": "2018-10-18T11:31:16.512Z",
  "created_date": "2018-10-18T11:31:16.512Z",
  "updated_date": "2018-10-18T11:31:16.512Z",
  "image": "string",
  "id": 0,
  "accountId": 0
}
```

